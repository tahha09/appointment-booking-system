<div
  class="min-h-[calc(100vh-120px)] flex items-center justify-center bg-gradient-to-br from-brand-deep via-brand-teal-light to-brand-slate py-10 px-4"
>
  <div
    class="w-full max-w-5xl bg-transparent backdrop-blur-xl border border-white/40 rounded-[2.25rem] shadow-[0_24px_80px_rgba(0,0,0,0.35)] overflow-hidden grid grid-cols-1 md:grid-cols-2"
  >
    <!-- Left panel -->
    <div
      class="hidden md:flex flex-col justify-between bg-gradient-to-b from-brand-deep via-brand-teal to-brand-slate text-white p-10 relative"
    >
      <div class="absolute inset-0 opacity-20 pointer-events-none">
        <div
          class="absolute -top-10 -right-16 h-40 w-40 rounded-full bg-brand-ice blur-3xl"
        ></div>
        <div
          class="absolute bottom-0 left-8 h-32 w-32 rounded-full bg-brand-teal-light blur-3xl"
        ></div>
      </div>

      <div class="relative z-10 space-y-6">
        <div
          class="inline-flex items-center gap-2 rounded-full bg-white/10 px-4 py-1 text-xs font-medium tracking-[0.25em] uppercase text-white/80"
        >
          <span
            class="h-1.5 w-1.5 rounded-full bg-brand-teal-light shadow-[0_0_12px_rgba(255,255,255,0.8)]"
          ></span>
          <span>Create Account</span>
        </div>
        <h2 class="text-3xl font-semibold leading-tight">
          Join our digital healthcare platform.
        </h2>
        <p class="text-sm text-white/80 max-w-sm">
          Book appointments, manage visits, and securely chat with your doctors whenever you need
          them.
        </p>

        <div class="mt-4 space-y-3 text-sm text-white/80">
          <div class="flex items-center gap-3">
            <span class="flex h-7 w-7 items-center justify-center rounded-full bg-white/10">
              ✓
            </span>
            <p>Personalized doctor and specialty recommendations.</p>
          </div>
          <div class="flex items-center gap-3">
            <span class="flex h-7 w-7 items-center justify-center rounded-full bg-white/10">
              ✓
            </span>
            <p>Paperless prescriptions and medical history.</p>
          </div>
        </div>
      </div>

      <div class="relative z-10 mt-10">
        <p class="text-xs text-white/70">Already have an account?</p>
        <a
          routerLink="/login"
          class="mt-3 inline-flex items-center text-sm font-medium text-white gap-2"
        >
          Sign in instead
          <span
            class="inline-flex h-7 w-7 items-center justify-center rounded-full bg-white/10 border border-white/20"
          >
            &rarr;
          </span>
        </a>
      </div>
    </div>

    <!-- Form panel -->
    <div class="p-7 sm:p-10 bg-transparent">
      <div class="mb-6">
        <div class="inline-flex items-center gap-2 rounded-full bg-white/20 px-3 py-1">
          <span
            class="h-2 w-2 rounded-full bg-brand-ice shadow-[0_0_10px_rgba(255,255,255,0.8)]"
          ></span>
          <p class="text-[0.65rem] font-semibold tracking-[0.25em] uppercase text-white">
            Sign Up
          </p>
        </div>
        <h1 class="mt-3 text-2xl sm:text-3xl font-semibold text-white">
          Create your account
        </h1>
      </div>

      <form [formGroup]="form" (ngSubmit)="onSubmit()" class="space-y-5">
        <div class="space-y-1.5">
          <label for="fullName" class="block text-sm font-medium text-white/90">Full Name</label>
          <div class="relative">
              <span
              class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-4 text-brand-ice"
            >
              <svg class="h-4 w-4" viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M12 3a4 4 0 1 1-4 4 4 4 0 0 1 4-4Zm0 8c-4.42 0-8 2.24-8 5v1a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1v-1c0-2.76-3.58-5-8-5Z"
                />
              </svg>
            </span>
              <input
              id="fullName"
              type="text"
              formControlName="fullName"
              class="block w-full rounded-2xl border border-white/40 bg-transparent pl-11 pr-4 py-3 text-sm outline-none transition focus:border-brand-teal focus:ring-2 focus:ring-brand-ice/60"
              placeholder="Eslam Ghanem"
            />
          </div>
          <div class="min-h-[1.25rem]">
              <p
                *ngIf="form.get('fullName')?.touched && form.get('fullName')?.invalid"
                class="text-xs text-red-300"
              >
              Please enter your full name.
            </p>
          </div>
        </div>

        <div class="space-y-1.5">
          <label for="email" class="block text-sm font-medium text-white/90">Email</label>
          <div class="relative">
            <span
              class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-4 text-brand-ice"
            >
              <svg class="h-4 w-4" viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M4 5h16a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V6a1 1 0 0 1 1-1Zm1.5 2 6.5 4.06L18.5 7h-13Z"
                />
              </svg>
            </span>
            <input
              id="email"
              type="email"
              formControlName="email"
              autocomplete="email"
              class="block w-full rounded-2xl border border-white/40 bg-transparent pl-11 pr-4 py-3 text-sm outline-none transition focus:border-brand-teal focus:ring-2 focus:ring-brand-ice/60"
              placeholder="you@example.com"
            />
          </div>
          <div class="min-h-[1.25rem]">
            <p
              *ngIf="form.get('email')?.touched && form.get('email')?.invalid"
              class="text-xs text-red-300"
            >
              Please enter a valid email address.
            </p>
          </div>
        </div>

        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div class="space-y-1.5">
            <label for="password" class="block text-sm font-medium text-white/90">
              Password
            </label>
            <div class="relative">
              <span
                class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-4 text-brand-ice"
              >
                <svg class="h-4 w-4" viewBox="0 0 24 24" aria-hidden="true">
                  <path
                    d="M12 2a5 5 0 0 0-5 5v3H6a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7a2 2 0 0 0-2-2h-1V7a5 5 0 0 0-5-5Zm-3 5a3 3 0 0 1 6 0v3H9V7Zm3 6a1.5 1.5 0 0 1 .75 2.8V18a.75.75 0 0 1-1.5 0v-2.2A1.5 1.5 0 0 1 12 13Z"
                  />
                </svg>
              </span>
              <input
                id="password"
                [type]="showPassword ? 'text' : 'password'"
                formControlName="password"
                autocomplete="new-password"
                class="block w-full rounded-2xl border border-white/40 bg-transparent pl-11 pr-4 py-3 text-sm outline-none transition focus:border-brand-teal focus:ring-2 focus:ring-brand-ice/60"
                placeholder="••••••••"
              />
              <button
                type="button"
                class="absolute inset-y-0 right-0 flex items-center pr-3 text-brand-ice/80 hover:text-white transition"
                (click)="showPassword = !showPassword"
                aria-label="Toggle password visibility"
              >
                <svg class="h-4 w-4" viewBox="0 0 24 24" aria-hidden="true">
                  <path
                    d="M12 5c-4.5 0-8.3 2.9-9.5 7 1.2 4.1 5 7 9.5 7s8.3-2.9 9.5-7c-1.2-4.1-5-7-9.5-7Zm0 2c3.1 0 5.8 1.8 7 5-1.2 3.2-3.9 5-7 5s-5.8-1.8-7-5c1.2-3.2 3.9-5 7-5Zm0 2a3 3 0 1 0 0 6 3 3 0 0 0 0-6Z"
                  />
                </svg>
              </button>
            </div>
            <div class="min-h-[1.25rem]">
              <p
                *ngIf="form.get('password')?.touched && form.get('password')?.invalid"
                class="text-xs text-red-300"
              >
                Password must be at least 6 characters.
              </p>
            </div>
          </div>

          <div class="space-y-1.5">
            <label for="confirmPassword" class="block text-sm font-medium text-white/90">
              Confirm Password
            </label>
            <div class="relative">
              <span
                class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-4 text-brand-ice"
              >
                <svg class="h-4 w-4" viewBox="0 0 24 24" aria-hidden="true">
                  <path
                    d="M12 2a5 5 0 0 0-5 5v3H6a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7a2 2 0 0 0-2-2h-1V7a5 5 0 0 0-5-5Zm-3 5a3 3 0 0 1 6 0v3H9V7Zm3 6a1.5 1.5 0 0 1 .75 2.8V18a.75.75 0 0 1-1.5 0v-2.2A1.5 1.5 0 0 1 12 13Z"
                  />
                </svg>
              </span>
              <input
                id="confirmPassword"
                [type]="showConfirmPassword ? 'text' : 'password'"
                formControlName="confirmPassword"
                autocomplete="new-password"
                class="block w-full rounded-2xl border border-white/40 bg-transparent pl-11 pr-4 py-3 text-sm outline-none transition focus:border-brand-teal focus:ring-2 focus:ring-brand-ice/60"
                placeholder="••••••••"
              />
              <button
                type="button"
                class="absolute inset-y-0 right-0 flex items-center pr-3 text-brand-ice/80 hover:text-white transition"
                (click)="showConfirmPassword = !showConfirmPassword"
                aria-label="Toggle password visibility"
              >
                <svg class="h-4 w-4" viewBox="0 0 24 24" aria-hidden="true">
                  <path
                    d="M12 5c-4.5 0-8.3 2.9-9.5 7 1.2 4.1 5 7 9.5 7s8.3-2.9 9.5-7c-1.2-4.1-5-7-9.5-7Zm0 2c3.1 0 5.8 1.8 7 5-1.2 3.2-3.9 5-7 5s-5.8-1.8-7-5c1.2-3.2 3.9-5 7-5Zm0 2a3 3 0 1 0 0 6 3 3 0 0 0 0-6Z"
                  />
                </svg>
              </button>
            </div>
            <div class="min-h-[1.25rem]">
              <p *ngIf="passwordsMismatch" class="text-xs text-red-300">
                Passwords do not match.
              </p>
            </div>
          </div>
        </div>

        <div class="space-y-2">
          <p class="text-xs font-medium text-white/80">Profile image (optional)</p>
          <div class="flex items-center gap-3">
            <div
              class="h-12 w-12 rounded-full overflow-hidden border border-white/40 bg-white/10 flex items-center justify-center"
            >
              <ng-container *ngIf="selectedImagePreview; else noImage">
                <img
                  [src]="selectedImagePreview"
                  alt="Profile preview"
                  class="h-full w-full object-cover"
                />
              </ng-container>
              <ng-template #noImage>
                <span class="text-[0.6rem] text-white/70 px-1 text-center">No image</span>
              </ng-template>
            </div>
            <label
              class="inline-flex items-center gap-2 rounded-xl border border-white/30 bg-white/10 px-3 py-2 text-xs text-white/80 cursor-pointer hover:bg-white/20 transition"
            >
              <svg class="h-3.5 w-3.5" viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M12 5a1 1 0 0 1 1 1v6.59l2.3-2.3a1 1 0 0 1 1.4 1.42l-4 4a1 1 0 0 1-1.4 0l-4-4a1 1 0 1 1 1.4-1.42L11 12.59V6a1 1 0 0 1 1-1Zm-7 9a1 1 0 0 1 1 1 5 5 0 0 0 10 0 1 1 0 0 1 2 0 7 7 0 0 1-14 0 1 1 0 0 1 1-1Z"
                />
              </svg>
              <span>Upload image</span>
              <input
                type="file"
                accept="image/*"
                class="hidden"
                (change)="onProfileImageSelected($event)"
              />
            </label>
          </div>
        </div>

        <div class="space-y-3">
          <p class="text-xs font-medium text-white/80">Register as</p>
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
            <button
              type="button"
              class="flex flex-col items-start gap-1 rounded-2xl border px-4 py-3 text-left text-xs sm:text-sm transition cursor-pointer"
              [ngClass]="
                form.get('role')?.value === 'patient'
                  ? 'border-brand-ice bg-white/15 text-white shadow-lg shadow-brand-ice/30'
                  : 'border-white/30 bg-white/5 text-white/80 hover:border-brand-ice/70'
              "
              (click)="form.get('role')?.setValue('patient')"
            >
              <span class="text-[0.7rem] font-semibold uppercase tracking-[0.18em] text-brand-ice">
                Patient
              </span>
              <span class="text-[0.7rem] text-white/70">
                Book appointments and track your medical visits.
              </span>
            </button>

            <button
              type="button"
              class="flex flex-col items-start gap-1 rounded-2xl border px-4 py-3 text-left text-xs sm:text-sm transition cursor-pointer"
              [ngClass]="
                form.get('role')?.value === 'doctor'
                  ? 'border-brand-ice bg-white/15 text-white shadow-lg shadow-brand-ice/30'
                  : 'border-white/30 bg-white/5 text-white/80 hover:border-brand-ice/70'
              "
              (click)="form.get('role')?.setValue('doctor')"
            >
              <span class="text-[0.7rem] font-semibold uppercase tracking-[0.18em] text-brand-ice">
                Doctor
              </span>
              <span class="text-[0.7rem] text-white/70">
                Manage your patients, schedule and appointments.
              </span>
            </button>
          </div>
        </div>

        <!-- Specialization Selection for Doctors -->
        <div class="space-y-1.5" *ngIf="form.get('role')?.value === 'doctor'">
          <label for="specializationId" class="block text-sm font-medium text-white/90">Medical Specialization</label>
          <div class="relative">
            <span
              class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-4 text-brand-ice"
            >
              <svg class="h-4 w-4" viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
                />
              </svg>
            </span>
            <select
              id="specializationId"
              formControlName="specializationId"
              class="block w-full rounded-2xl border border-white/40 bg-transparent pl-11 pr-4 py-3 text-sm outline-none transition focus:border-brand-teal focus:ring-2 focus:ring-brand-ice/60"
            >
              <option value="" disabled selected class="text-gray-500">Select your specialization</option>
              <option
                *ngFor="let specialization of specializations"
                [value]="specialization.id"
                class="text-gray-900"
              >
                {{ specialization.name }}
              </option>
            </select>
          </div>
          <div class="min-h-[1.25rem]">
            <p
              *ngIf="form.get('specializationId')?.touched && form.get('specializationId')?.invalid"
              class="text-xs text-red-300"
            >
              Please select a medical specialization.
            </p>
          </div>
        </div>

        <div
          *ngIf="apiError"
          class="rounded-xl border border-red-400 bg-red-500/15 px-3 py-2 text-xs text-red-100"
        >
          {{ apiError }}
        </div>

        <button
          type="submit"
          [disabled]="isSubmitting"
          class="inline-flex w-full items-center justify-center rounded-2xl bg-gradient-to-r from-brand-ice via-brand-teal to-brand-forest px-4 py-3 text-sm font-semibold text-slate-950 shadow-lg shadow-brand-teal/50 transition hover:from-brand-teal hover:via-brand-forest hover:to-brand-deep disabled:cursor-not-allowed disabled:opacity-70"
        >
          <span *ngIf="!isSubmitting">Create account</span>
          <span *ngIf="isSubmitting">Creating account...</span>
        </button>

        <div class="pt-2">
          <div class="flex items-center gap-3 text-[0.7rem] text-white/60">
            <div class="h-px flex-1 bg-white/30"></div>
            <span>or continue with</span>
            <div class="h-px flex-1 bg-white/30"></div>
          </div>
          <div class="mt-3 flex justify-center gap-3">
            <button type="button" (click)="registerWithGoogle()"
              class="flex h-9 w-9 items-center justify-center rounded-full border border-white/30 text-white/70 hover:border-brand-teal/60 hover:text-brand-teal transition">
              <svg class="h-4 w-4" viewBox="0 0 24 24" aria-hidden="true">
                <path fill="currentColor" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                <path fill="currentColor" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                <path fill="currentColor" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                <path fill="currentColor" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
              </svg>
            </button>
            <!-- <button type="button"
              class="flex h-9 w-9 items-center justify-center rounded-full border border-white/30 text-white/70 hover:border-brand-teal/60 hover:text-brand-teal transition">
              <span class="text-xs font-semibold">f</span>
            </button>
            <button type="button"
              class="flex h-9 w-9 items-center justify-center rounded-full border border-white/30 text-white/70 hover:border-brand-teal/60 hover:text-brand-teal transition">
              <span class="text-xs font-semibold">in</span>
            </button> -->
          </div>
        </div>

        <p class="pt-4 text-center text-xs text-white/80">
          Already have an account?
          <a
            routerLink="/login"
            class="font-semibold text-brand-ice hover:text-white"
          >
            Sign in
          </a>
        </p>
      </form>
    </div>
  </div>
<!--
  <button
    type="button"
    class="fixed bottom-6 right-6 z-50"
    *ngIf="showScrollTop"
    (click)="scrollToTop()"
    aria-label="Scroll to top"
  >
      <div
        class="h-11 w-11 rounded-full flex items-center justify-center border border-white/60 shadow-xl backdrop-blur-md"
      [ngStyle]="{
        'background-image':
          'conic-gradient(#0C969C ' + scrollProgress + '%, rgba(15,23,42,0.9) 0)'
      }"
      >
        <div
          class="h-8 w-8 rounded-full flex items-center justify-center bg-white text-brand-teal shadow-[0_0_14px_rgba(255,255,255,0.9)]"
        >
          <svg class="h-4 w-4" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M12 5L5 12h4v7h6v-7h4z" fill="currentColor" />
          </svg>
        </div>
      </div>
  </button> -->
</div>
